{% extends "base.html.twig" %}

{% block title %}Product list page{% endblock %}

{% block content %}
    <h1>Product {{ product.name }}:</h1>
    {% embed 'incs/card.html.twig' with {'big_image': 'true'} %}
        {% block buttons %}
            {% if is_granted('ROLE_ADMIN') %}
                <a href="{{ path('product_api', {'id': product.id}) }}" target="_blank">
                    API
                </a>
            {% endif %}

            {{ parent('buttons') }}
        {% endblock %}
    {% endembed %}

    {% if categoryProducts %}
        <h2>Products in category - {{ product.category.name }}</h2>
    {% endif %}
    <div class="cards">
        {% for categoryProduct in categoryProducts %}
            {% embed 'incs/card.html.twig' with {'product': categoryProduct} %}
                {% block buttons %}
                    <a href="{{ path('product', {'slug': product.slug}) }}">
                        Open product
                    </a>

                    {% if is_granted('ROLE_ADMIN') %}
                        <a href="{{ path('product_api', {'id': product.id}) }}" target="_blank">
                            API
                        </a>
                    {% endif %}

                    {{ parent('buttons') }}
                {% endblock %}
            {% endembed %}
        {% endfor %}
    </div>
{% endblock %}
